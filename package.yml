name       : libvirt
version    : 6.7.0
release    : 30
source     :
    - https://libvirt.org/sources/libvirt-6.7.0.tar.xz : 655b9476c797cdd3bb12e2520acc37335e5299b2d56a5bb9ab3f55db40161342
license    :
    - GPL-2.0-or-later
    - LGPL-2.1-or-later
component  : virt
summary    : Library providing a simple virtualization API
description: |
    A toolkit to interact with the virtualization capabilities of recent versions of Linux
builddeps  :
    - pkgconfig(devmapper)
    - pkgconfig(fuse)
    - pkgconfig(gnutls)
    - pkgconfig(libacl)
    - pkgconfig(libattr)
    - pkgconfig(libcap-ng)
    - pkgconfig(libiptc)
    - pkgconfig(libnl-3.0)
    - pkgconfig(libparted)
    - pkgconfig(libpcap)
    - pkgconfig(libssh)
    - pkgconfig(libtirpc)
    - pkgconfig(libxml-2.0)
    - pkgconfig(pciaccess)
    - pkgconfig(yajl)
    - dmidecode
    - dnsmasq
    - ebtables
    - parted
    - python-docutils
rundeps    :
    - dmidecode
    - dnsmasq
    - ebtables
    - parted
setup      : |
    #mkdir build
    #cd build
    # ../configure ac_cv_path_EBTABLES_PATH=/usr/bin/ebtables \
    %meson_configure \
        -Dchrdev_lock_files='/run/lock' \
        -Ddriver_interface=enabled \
        -Ddriver_libvirtd=enabled \
        -Ddriver_network=enabled \
        -Ddriver_qemu=enabled \
        -Dfirewalld=disabled \
        -Dinit_script='systemd' \
        -Drunstatedir='/run' \
        -Dselinux=disabled
    #exit 1
build      : |
    %ninja_build
install    : |
    %ninja_install

    install -Dm00644 $pkgfiles/libvirt.sysusers $installdir/%libdir%/sysusers.d/libvirt.conf
    install -Dm00644 $pkgfiles/libvirt.tmpfiles $installdir/%libdir%/tmpfiles.d/libvirt.conf

    # Support keyfile backend in libvirt
    install -Dm00644 $pkgfiles/50-libvirt.keyrules -t $installdir/usr/share/polkit-1/rules.d

    rm -rf $installdir/usr/share/doc
